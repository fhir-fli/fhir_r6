{
    "resourceType": "StructureMap",
    "id": "RadOrderQrToBundle",
    "url": "http://fhir.ch/ig/ch-rad-order/StructureMap/RadOrderQrToBundle",
    "name": "RadOrderQrToBundle",
    "status": "draft",
    "description": "Radiologoy QuestionnaireResponse to Bundle",
    "structure": [
        {
            "url": "http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse",
            "mode": "source",
            "alias": "QuestionnaireResponse"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Bundle",
            "mode": "target",
            "alias": "Bundle"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Patient",
            "mode": "target",
            "alias": "Patient"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Organization",
            "mode": "target",
            "alias": "Organization"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Practitioner",
            "mode": "target",
            "alias": "Practitioner"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/PractitionerRole",
            "mode": "target",
            "alias": "PractitionerRole"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/ServiceRequest",
            "mode": "target",
            "alias": "ServiceRequest"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/BackboneElement",
            "mode": "target",
            "alias": "BackboneElement"
        }
    ],
    "import": [
        "http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle"
    ],
    "group": [
        {
            "name": "RadOrderQrToBundle",
            "typeMode": "none",
            "input": [
                {
                    "name": "qr",
                    "type": "QuestionnaireResponse",
                    "mode": "source"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "documentIdentifier",
                    "source": [
                        {
                            "context": "qr"
                        }
                    ],
                    "target": [
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "identifier",
                            "variable": "documentIdentifier"
                        },
                        {
                            "context": "documentIdentifier",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "urn:ietf:rfc:3986"
                                }
                            ]
                        },
                        {
                            "contextType": "variable",
                            "variable": "uuidDoc",
                            "transform": "uuid"
                        },
                        {
                            "context": "documentIdentifier",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuidDoc"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "orfbundle",
                    "source": [
                        {
                            "context": "qr",
                            "variable": "qrcp"
                        }
                    ],
                    "target": [
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "composition",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "Composition"
                                }
                            ]
                        },
                        {
                            "context": "composition",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid",
                            "transform": "uuid"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        },
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e2"
                        },
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "timestamp",
                            "variable": "timestamp",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "now()"
                                }
                            ]
                        },
                        {
                            "context": "composition",
                            "contextType": "variable",
                            "element": "date",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "timestamp"
                                }
                            ]
                        },
                        {
                            "context": "e2",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "patient",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "Patient"
                                }
                            ]
                        },
                        {
                            "context": "patient",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid2",
                            "transform": "uuid"
                        },
                        {
                            "context": "e2",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid2"
                                }
                            ]
                        },
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e4"
                        },
                        {
                            "context": "e4",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "questionnaireresp",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "qrcp"
                                }
                            ]
                        },
                        {
                            "context": "questionnaireresp",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid4",
                            "transform": "uuid"
                        },
                        {
                            "context": "e4",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid4"
                                }
                            ]
                        },
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e5"
                        },
                        {
                            "context": "e5",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "servicerequest",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "ServiceRequest"
                                }
                            ]
                        },
                        {
                            "context": "servicerequest",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid5",
                            "transform": "uuid"
                        },
                        {
                            "context": "e5",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid5"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "orfbundle",
                            "source": [
                                {
                                    "context": "qr",
                                    "element": "questionnaire",
                                    "variable": "can"
                                }
                            ],
                            "target": [
                                {
                                    "context": "bundle",
                                    "contextType": "variable",
                                    "element": "entry",
                                    "variable": "e6"
                                },
                                {
                                    "context": "e6",
                                    "contextType": "variable",
                                    "element": "resource",
                                    "variable": "q",
                                    "transform": "evaluate",
                                    "parameter": [
                                        {
                                            "valueString": "can.resolve()"
                                        }
                                    ]
                                },
                                {
                                    "context": "q",
                                    "contextType": "variable",
                                    "element": "id",
                                    "variable": "uuid6",
                                    "transform": "uuid"
                                },
                                {
                                    "context": "e6",
                                    "contextType": "variable",
                                    "element": "fullUrl",
                                    "transform": "append",
                                    "parameter": [
                                        {
                                            "valueString": "urn:uuid:"
                                        },
                                        {
                                            "valueId": "uuid6"
                                        }
                                    ]
                                }
                            ],
                            "dependent": [
                                {
                                    "name": "QrToBundle",
                                    "variable": [
                                        "qr",
                                        "q",
                                        "patient",
                                        "questionnaireresp",
                                        "servicerequest",
                                        "composition",
                                        "bundle"
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "servicerequest",
                            "source": [
                                {
                                    "context": "qr"
                                }
                            ],
                            "dependent": [
                                {
                                    "name": "RadOrderQrToServiceRequest",
                                    "variable": [
                                        "qr",
                                        "patient",
                                        "bundle",
                                        "composition",
                                        "servicerequest"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "RadOrderQrToServiceRequest",
            "typeMode": "none",
            "input": [
                {
                    "name": "qr",
                    "type": "QuestionnaireResponse",
                    "mode": "source"
                },
                {
                    "name": "patient",
                    "type": "Patient",
                    "mode": "target"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "composition",
                    "type": "Composition",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "requestedService",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'requestedService'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "RequestedServiceItems",
                            "variable": [
                                "grp",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "reason",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'reason'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "ReasonServiceItems",
                            "variable": [
                                "grp",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "imagingService",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'imagingService'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "ImagingServiceItems",
                            "variable": [
                                "grp",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "orderDetail",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'orderDetail'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "OrderDetailServiceItems",
                            "variable": [
                                "grp",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "desiredRadiologist",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'desiredRadiologist'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "DesiredRadiologistServiceItems",
                            "variable": [
                                "grp",
                                "bundle",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "diagnosisList",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'diagnosisList'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "DiagnosisListServiceItems",
                            "variable": [
                                "grp",
                                "patient",
                                "bundle",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "Caveat",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'caveat'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "CaveatServiceItems",
                            "variable": [
                                "grp",
                                "patient",
                                "bundle",
                                "serviceRequest"
                            ]
                        }
                    ]
                },
                {
                    "name": "previousResults",
                    "source": [
                        {
                            "context": "qr",
                            "element": "item",
                            "variable": "grp",
                            "condition": "linkId = 'previousResults'"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "PreviousImagingStudyResults",
                            "variable": [
                                "grp",
                                "bundle",
                                "serviceRequest",
                                "patient"
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "RequestedServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'requestedService.service') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "requestedService.service",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "ReasonServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'reason.question') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "reason.question",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "string",
                                            "element": "value",
                                            "variable": "value"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "reasonCode",
                                            "variable": "reasonCode"
                                        },
                                        {
                                            "context": "reasonCode",
                                            "contextType": "variable",
                                            "element": "text",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "value"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "ImagingServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'imagingService.type') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "requestedService.service",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "OrderDetailServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.imagingRegion') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.imagingRegion",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "orderDetail",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "extension",
                                            "variable": "ext"
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "url",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "value",
                                            "variable": "coding",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Coding"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "imagingRegion"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.imagingFocus') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.imagingFocus",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "bodySite",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.laterality') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.laterality",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "orderDetail",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "extension",
                                            "variable": "ext"
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "url",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "value",
                                            "variable": "coding",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Coding"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "laterality"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.viewType') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.viewType",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "orderDetail",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "extension",
                                            "variable": "ext"
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "url",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "value",
                                            "variable": "coding",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Coding"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "viewType"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.maneuverType') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.maneuverType",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "orderDetail",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "extension",
                                            "variable": "ext"
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "url",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "value",
                                            "variable": "coding",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Coding"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "maneuverType"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'orderDetail.guidanceForAction') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueCoding",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "orderDetail.guidanceForAction",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "Coding",
                                            "element": "value",
                                            "variable": "coding"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "orderDetail",
                                            "variable": "cc"
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "extension",
                                            "variable": "ext"
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "url",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/StructureDefinition/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "ext",
                                            "contextType": "variable",
                                            "element": "value",
                                            "variable": "coding",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Coding"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://fhir.ch/ig/ch-rad-order/CodeSystem/ch-rad-order-order-detail-type"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "guidanceForAction"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "cc",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "coding"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "DesiredRadiologistServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "serviceRequest.performer",
                    "source": [
                        {
                            "context": "src"
                        }
                    ],
                    "target": [
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "practitioner",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "Practitioner"
                                }
                            ]
                        },
                        {
                            "context": "practitioner",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid",
                            "transform": "uuid"
                        },
                        {
                            "context": "serviceRequest",
                            "contextType": "variable",
                            "element": "performer",
                            "variable": "performer"
                        },
                        {
                            "context": "performer",
                            "contextType": "variable",
                            "element": "reference",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "item",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "item",
                                    "variable": "item",
                                    "condition": "((linkId.value = 'desiredRadiologist.familyName') and answer.exists())"
                                }
                            ],
                            "target": [
                                {
                                    "context": "practitioner",
                                    "contextType": "variable",
                                    "element": "name",
                                    "variable": "name",
                                    "listMode": [
                                        "share"
                                    ],
                                    "listRuleId": "name"
                                },
                                {
                                    "context": "name",
                                    "contextType": "variable",
                                    "element": "family",
                                    "transform": "evaluate",
                                    "parameter": [
                                        {
                                            "valueString": "item.answer.value"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "item",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "item",
                                    "variable": "item",
                                    "condition": "((linkId.value = 'desiredRadiologist.givenName') and answer.exists())"
                                }
                            ],
                            "target": [
                                {
                                    "context": "practitioner",
                                    "contextType": "variable",
                                    "element": "name",
                                    "variable": "name",
                                    "listMode": [
                                        "share"
                                    ],
                                    "listRuleId": "name"
                                },
                                {
                                    "context": "name",
                                    "contextType": "variable",
                                    "element": "given",
                                    "transform": "evaluate",
                                    "parameter": [
                                        {
                                            "valueString": "item.answer.value"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "DiagnosisListServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "patient",
                    "type": "Patient",
                    "mode": "target"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'diagnosisList.secondaryDiagnosis') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "diagnosisList.secondaryDiagnosis",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "string",
                                            "element": "value",
                                            "variable": "value"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "text",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "value"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "CaveatServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "patient",
                    "type": "Patient",
                    "mode": "target"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.bloodCoagulation') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.bloodCoagulation",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "64779008"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Blood coagulation disorder (disorder)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.renalInsufficiency') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.renalInsufficiency",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "723188008"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Renal insufficiency (disorder)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ],
                                    "rule": [
                                        {
                                            "name": "RenalInsufficiencyCreatinineServiceItems",
                                            "source": [
                                                {
                                                    "context": "answer",
                                                    "element": "item",
                                                    "variable": "item2",
                                                    "condition": "(linkId.value = 'caveat.renalInsufficiency.creatinine')"
                                                }
                                            ],
                                            "dependent": [
                                                {
                                                    "name": "RenalInsufficiencyCreatinineServiceItems",
                                                    "variable": [
                                                        "item2",
                                                        "patient",
                                                        "bundle",
                                                        "serviceRequest",
                                                        "condition"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.claustrophobia') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.claustrophobia",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "19887002"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Claustrophobia (finding)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.bodyPiercing') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.bodyPiercing",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "879862001"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Body piercing (finding)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.device') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.device",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "string",
                                            "element": "value",
                                            "variable": "value"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "397578001"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Device in situ (finding)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "note",
                                            "variable": "note"
                                        },
                                        {
                                            "context": "note",
                                            "contextType": "variable",
                                            "element": "text",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "value"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.hyperthyroidism') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.hyperthyroidism",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "34486009"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Hyperthyroidism (disorder)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.diabetes') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.diabetes",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "73211009"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Diabetes mellitus (disorder)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.gravida') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.gravida",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "366321006"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Finding of gravida (finding)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.contrastMediaAllergy') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.contrastMediaAllergy",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "boolean",
                                            "element": "value",
                                            "variable": "value",
                                            "condition": "answer.valueBoolean"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "293637006"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Allergy to contrast media (finding)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "item.answer",
                    "source": [
                        {
                            "context": "src",
                            "element": "item",
                            "variable": "item",
                            "condition": "((linkId.value = 'caveat.drugPrescription') and answer.exists())"
                        }
                    ],
                    "rule": [
                        {
                            "name": "answer.valueString",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "answer",
                                    "variable": "answer"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "caveat.drugPrescription",
                                    "source": [
                                        {
                                            "context": "answer",
                                            "type": "string",
                                            "element": "value",
                                            "variable": "value"
                                        }
                                    ],
                                    "target": [
                                        {
                                            "context": "bundle",
                                            "contextType": "variable",
                                            "element": "entry",
                                            "variable": "e"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "resource",
                                            "variable": "condition",
                                            "transform": "create",
                                            "parameter": [
                                                {
                                                    "valueString": "Condition"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "id",
                                            "variable": "uuid",
                                            "transform": "uuid"
                                        },
                                        {
                                            "context": "e",
                                            "contextType": "variable",
                                            "element": "fullUrl",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "serviceRequest",
                                            "contextType": "variable",
                                            "element": "supportingInfo",
                                            "variable": "supportingInfo"
                                        },
                                        {
                                            "context": "supportingInfo",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + uuid"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "category",
                                            "variable": "category"
                                        },
                                        {
                                            "context": "category",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding"
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "problem-list-item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://terminology.hl7.org/CodeSystem/condition-category"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Problem List Item"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "code",
                                            "variable": "code"
                                        },
                                        {
                                            "context": "code",
                                            "contextType": "variable",
                                            "element": "coding",
                                            "variable": "coding2"
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "code",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "182817000"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "system",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "http://snomed.info/sct"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "coding2",
                                            "contextType": "variable",
                                            "element": "display",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueString": "Drug prescription (situation)"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "subject",
                                            "variable": "subject"
                                        },
                                        {
                                            "context": "subject",
                                            "contextType": "variable",
                                            "element": "reference",
                                            "transform": "evaluate",
                                            "parameter": [
                                                {
                                                    "valueString": "'urn:uuid:' + patient.id"
                                                }
                                            ]
                                        },
                                        {
                                            "context": "condition",
                                            "contextType": "variable",
                                            "element": "note",
                                            "variable": "note"
                                        },
                                        {
                                            "context": "note",
                                            "contextType": "variable",
                                            "element": "text",
                                            "transform": "copy",
                                            "parameter": [
                                                {
                                                    "valueId": "value"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "RenalInsufficiencyCreatinineServiceItems",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "patient",
                    "type": "Patient",
                    "mode": "target"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                },
                {
                    "name": "condition",
                    "type": "Condition",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "observation",
                    "source": [
                        {
                            "context": "src"
                        }
                    ],
                    "target": [
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "observation",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "Observation"
                                }
                            ]
                        },
                        {
                            "context": "observation",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid",
                            "transform": "uuid"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        },
                        {
                            "context": "observation",
                            "contextType": "variable",
                            "element": "status",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "final"
                                }
                            ]
                        },
                        {
                            "context": "observation",
                            "contextType": "variable",
                            "element": "code",
                            "variable": "code"
                        },
                        {
                            "context": "code",
                            "contextType": "variable",
                            "element": "coding",
                            "variable": "coding2"
                        },
                        {
                            "context": "coding2",
                            "contextType": "variable",
                            "element": "code",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "723188008"
                                }
                            ]
                        },
                        {
                            "context": "coding2",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "http://snomed.info/sct"
                                }
                            ]
                        },
                        {
                            "context": "coding2",
                            "contextType": "variable",
                            "element": "display",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "Renal insufficiency (disorder)"
                                }
                            ]
                        },
                        {
                            "context": "condition",
                            "contextType": "variable",
                            "element": "evidence",
                            "variable": "evidence"
                        },
                        {
                            "context": "evidence",
                            "contextType": "variable",
                            "element": "detail",
                            "variable": "detail"
                        },
                        {
                            "context": "detail",
                            "contextType": "variable",
                            "element": "reference",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        },
                        {
                            "context": "observation",
                            "contextType": "variable",
                            "element": "subject",
                            "variable": "subject"
                        },
                        {
                            "context": "subject",
                            "contextType": "variable",
                            "element": "reference",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + patient.id"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "caveat.renalInsufficiency.creatinine.quantity",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "item",
                                    "variable": "item",
                                    "condition": "((linkId.value = 'caveat.renalInsufficiency.creatinine.quantity') and answer.exists())"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "item.answer",
                                    "source": [
                                        {
                                            "context": "item",
                                            "element": "answer",
                                            "variable": "answer"
                                        }
                                    ],
                                    "rule": [
                                        {
                                            "name": "valueQuantity",
                                            "source": [
                                                {
                                                    "context": "answer",
                                                    "type": "Quantity",
                                                    "element": "value",
                                                    "variable": "value"
                                                }
                                            ],
                                            "target": [
                                                {
                                                    "context": "observation",
                                                    "contextType": "variable",
                                                    "element": "value",
                                                    "transform": "copy",
                                                    "parameter": [
                                                        {
                                                            "valueId": "value"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "caveat.renalInsufficiency.creatinine.dateTime",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "item",
                                    "variable": "item",
                                    "condition": "((linkId.value = 'caveat.renalInsufficiency.creatinine.dateTime') and answer.exists())"
                                }
                            ],
                            "rule": [
                                {
                                    "name": "item.answer",
                                    "source": [
                                        {
                                            "context": "item",
                                            "element": "answer",
                                            "variable": "answer"
                                        }
                                    ],
                                    "rule": [
                                        {
                                            "name": "valueDateTime",
                                            "source": [
                                                {
                                                    "context": "answer",
                                                    "type": "dateTime",
                                                    "element": "value",
                                                    "variable": "value"
                                                }
                                            ],
                                            "target": [
                                                {
                                                    "context": "observation",
                                                    "contextType": "variable",
                                                    "element": "effective",
                                                    "transform": "copy",
                                                    "parameter": [
                                                        {
                                                            "valueId": "value"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "PreviousImagingStudyResults",
            "typeMode": "none",
            "input": [
                {
                    "name": "grp",
                    "type": "BackboneElement",
                    "mode": "source"
                },
                {
                    "name": "bundle",
                    "type": "Bundle",
                    "mode": "target"
                },
                {
                    "name": "serviceRequest",
                    "type": "ServiceRequest",
                    "mode": "target"
                },
                {
                    "name": "patient",
                    "type": "Patient",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "imagingStudy",
                    "source": [
                        {
                            "context": "grp",
                            "element": "item",
                            "variable": "item",
                            "condition": "(linkId.value = 'previousResults.imagingStudy')"
                        }
                    ],
                    "target": [
                        {
                            "context": "bundle",
                            "contextType": "variable",
                            "element": "entry",
                            "variable": "e"
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "resource",
                            "variable": "imagingStudy",
                            "transform": "create",
                            "parameter": [
                                {
                                    "valueString": "ImagingStudy"
                                }
                            ]
                        },
                        {
                            "context": "imagingStudy",
                            "contextType": "variable",
                            "element": "id",
                            "variable": "uuid",
                            "transform": "uuid"
                        },
                        {
                            "context": "imagingStudy",
                            "contextType": "variable",
                            "element": "status",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "available"
                                }
                            ]
                        },
                        {
                            "context": "e",
                            "contextType": "variable",
                            "element": "fullUrl",
                            "transform": "append",
                            "parameter": [
                                {
                                    "valueString": "urn:uuid:"
                                },
                                {
                                    "valueId": "uuid"
                                }
                            ]
                        },
                        {
                            "context": "serviceRequest",
                            "contextType": "variable",
                            "element": "subject",
                            "variable": "subject"
                        },
                        {
                            "context": "subject",
                            "contextType": "variable",
                            "element": "reference",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + patient.id"
                                }
                            ]
                        },
                        {
                            "context": "serviceRequest",
                            "contextType": "variable",
                            "element": "supportingInfo",
                            "variable": "supportingInfo"
                        },
                        {
                            "context": "supportingInfo",
                            "contextType": "variable",
                            "element": "reference",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + uuid"
                                }
                            ]
                        }
                    ],
                    "rule": [
                        {
                            "name": "uid",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "item",
                                    "variable": "dictomitem",
                                    "condition": "((linkId.value = 'previousResults.imagingStudy.uid') and answer.exists())"
                                }
                            ],
                            "target": [
                                {
                                    "context": "imagingStudy",
                                    "contextType": "variable",
                                    "element": "identifier",
                                    "variable": "uid"
                                },
                                {
                                    "context": "uid",
                                    "contextType": "variable",
                                    "element": "system",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "urn:dicom:uid"
                                        }
                                    ]
                                },
                                {
                                    "context": "uid",
                                    "contextType": "variable",
                                    "element": "use",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "official"
                                        }
                                    ]
                                },
                                {
                                    "context": "uid",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "evaluate",
                                    "parameter": [
                                        {
                                            "valueString": "'urn:oid:' + dictomitem.answer.value"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "acsn",
                            "source": [
                                {
                                    "context": "item",
                                    "element": "item",
                                    "variable": "dictomitem",
                                    "condition": "((linkId.value = 'previousResults.imagingStudy.acsn') and answer.exists())"
                                }
                            ],
                            "target": [
                                {
                                    "context": "imagingStudy",
                                    "contextType": "variable",
                                    "element": "identifier",
                                    "variable": "acsn"
                                },
                                {
                                    "context": "acsn",
                                    "contextType": "variable",
                                    "element": "type",
                                    "variable": "type"
                                },
                                {
                                    "context": "type",
                                    "contextType": "variable",
                                    "element": "coding",
                                    "variable": "coding"
                                },
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "system",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "http://terminology.hl7.org/CodeSystem/v2-0203"
                                        }
                                    ]
                                },
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "code",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "ACSN"
                                        }
                                    ]
                                },
                                {
                                    "context": "acsn",
                                    "contextType": "variable",
                                    "element": "use",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "usual"
                                        }
                                    ]
                                },
                                {
                                    "context": "acsn",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "evaluate",
                                    "parameter": [
                                        {
                                            "valueString": "'urn:oid:' + dictomitem.answer.value"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}