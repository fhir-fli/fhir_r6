{
    "resourceType": "StructureMap",
    "id": "CdaToFhirTypes",
    "contained": [
        {
            "resourceType": "ConceptMap",
            "id": "addressUse",
            "status": "draft",
            "group": [
                {
                    "source": "http://terminology.hl7.org/ValueSet/v3-AddressUse",
                    "target": "http://hl7.org/fhir/valueset-address-use.html",
                    "element": [
                        {
                            "code": "H",
                            "target": [
                                {
                                    "code": "home",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "HP",
                            "target": [
                                {
                                    "code": "home",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "HV",
                            "target": [
                                {
                                    "code": "home",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "WP",
                            "target": [
                                {
                                    "code": "work",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "DIR",
                            "target": [
                                {
                                    "code": "work",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "PUB",
                            "target": [
                                {
                                    "code": "work",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "TMP",
                            "target": [
                                {
                                    "code": "temp",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "OLD",
                            "target": [
                                {
                                    "code": "old",
                                    "equivalence": "equivalent"
                                }
                            ]
                        },
                        {
                            "code": "BAD",
                            "target": [
                                {
                                    "code": "old",
                                    "equivalence": "equivalent"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ],
    "url": "http://fhir.ch/ig/cda-fhir-maps/StructureMap/CdaToFhirTypes",
    "name": "CdaToFhirTypes",
    "status": "draft",
    "description": "Adapted from https://github.com/HL7/ccda-to-fhir/tree/master/mappings\r\nCDA:  http://build.fhir.org/ig/ahdis/cda-core-2.0/branches/master/index.html\r\nFHIR: http://hl7.org/fhir/r4/",
    "structure": [
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/ED",
            "mode": "source",
            "alias": "ED"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/II",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Identifier",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/TS",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/instant",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/CS",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/code",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/CE",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/CodeableConcept",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/ST",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/string",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/EN",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/HumanName",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/AD",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Address",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/TEL",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/ContactPoint",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/BL",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/boolean",
            "mode": "target"
        },
        {
            "url": "http://hl7.org/fhir/cda/StructureDefinition/IVL-TS",
            "mode": "source"
        },
        {
            "url": "http://hl7.org/fhir/StructureDefinition/Period",
            "mode": "target"
        }
    ],
    "group": [
        {
            "name": "Any",
            "typeMode": "none",
            "input": [
                {
                    "name": "src",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "II",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "II",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Identifier",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "root1",
                    "source": [
                        {
                            "context": "src",
                            "element": "root",
                            "variable": "r",
                            "condition": "src.extension.exists()"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "translate",
                            "parameter": [
                                {
                                    "valueId": "r"
                                },
                                {
                                    "valueString": "http://hl7.org/fhir/ConceptMap/special-oid2uri"
                                },
                                {
                                    "valueString": "uri"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "rootuuid",
                    "source": [
                        {
                            "context": "src",
                            "element": "root",
                            "variable": "r",
                            "condition": "src.extension.empty() and src.root.matches('[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}')"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "urn:ietf:rfc:3986"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "'urn:uuid:' + r.lower()"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "rootoid",
                    "source": [
                        {
                            "context": "src",
                            "element": "root",
                            "variable": "r",
                            "condition": "src.extension.empty() and src.root.contains('.')"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "urn:ietf:rfc:3986"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "append",
                            "parameter": [
                                {
                                    "valueString": "urn:oid:"
                                },
                                {
                                    "valueId": "r"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "extension",
                    "source": [
                        {
                            "context": "src",
                            "element": "extension",
                            "variable": "e"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "e"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "assigningAuthorityName",
                    "source": [
                        {
                            "context": "src",
                            "element": "assigningAuthorityName",
                            "variable": "s"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "assigner",
                            "variable": "a"
                        },
                        {
                            "context": "a",
                            "contextType": "variable",
                            "element": "display",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "s"
                                }
                            ]
                        }
                    ],
                    "documentation": "there's no equivalent for displayable in FHIR - and it probably will never matter, but if it does, it might map to Identifier.use."
                },
                {
                    "name": "extension",
                    "source": [
                        {
                            "context": "src",
                            "element": "displayable",
                            "variable": "displayable"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "extension",
                            "variable": "ext"
                        }
                    ],
                    "rule": [
                        {
                            "name": "url",
                            "source": [
                                {
                                    "context": "displayable"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "url",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "http://hl7.org/fhir/cdaStructureDefinition/extension-displayable"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "value",
                            "source": [
                                {
                                    "context": "displayable",
                                    "element": "value",
                                    "variable": "v"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "cast",
                                    "parameter": [
                                        {
                                            "valueId": "v"
                                        },
                                        {
                                            "valueString": "string"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "INT",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "INT",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "integer",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "integer",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "v"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "TemplateID",
            "typeMode": "none",
            "input": [
                {
                    "name": "template",
                    "type": "II",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "templateId",
                    "source": [
                        {
                            "context": "template"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "extension",
                            "variable": "ext"
                        }
                    ],
                    "rule": [
                        {
                            "name": "url",
                            "source": [
                                {
                                    "context": "template"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "url",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "http://hl7.org/fhir/cda/StructureDefinition/templateID"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "value",
                            "source": [
                                {
                                    "context": "template"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "value",
                                    "variable": "value",
                                    "transform": "create",
                                    "parameter": [
                                        {
                                            "valueString": "Identifier"
                                        }
                                    ]
                                }
                            ],
                            "dependent": [
                                {
                                    "name": "II",
                                    "variable": [
                                        "template",
                                        "value"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "Negation",
            "typeMode": "none",
            "input": [
                {
                    "name": "negation",
                    "type": "BL",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "negation",
                    "source": [
                        {
                            "context": "negation"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "modifierExtension",
                            "variable": "ext"
                        }
                    ],
                    "rule": [
                        {
                            "name": "url",
                            "source": [
                                {
                                    "context": "negation"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "url",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueString": "http://hl7.org/fhir/cda/StructureDefinition/negationIndicator"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "value",
                            "source": [
                                {
                                    "context": "negation",
                                    "variable": "neg"
                                }
                            ],
                            "target": [
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "create",
                                    "parameter": [
                                        {
                                            "valueString": "boolean"
                                        }
                                    ]
                                },
                                {
                                    "context": "ext",
                                    "contextType": "variable",
                                    "element": "value",
                                    "transform": "copy",
                                    "parameter": [
                                        {
                                            "valueId": "neg"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "TSInstant",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "TS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "instant",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "value",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "cast",
                            "parameter": [
                                {
                                    "valueId": "v"
                                },
                                {
                                    "valueString": "string"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "TSDateTime",
            "extends": "TSInstant",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "TS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "dateTime",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "TSDate",
            "extends": "TSInstant",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "TS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "date",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "IVLTSPeriod",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "IVL_TS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Period",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "low",
                    "source": [
                        {
                            "context": "src",
                            "element": "low",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "start",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ]
                },
                {
                    "name": "high",
                    "source": [
                        {
                            "context": "src",
                            "element": "high",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "end",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ]
                }
            ]
        },
        {
            "name": "IVLTSDateTime",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "IVL_TS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "dateTime",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "low",
                    "source": [
                        {
                            "context": "src",
                            "element": "low",
                            "variable": "s"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "TSDateTime",
                            "variable": [
                                "s",
                                "tgt"
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "STstring",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "ST",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "string",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "value",
                    "source": [
                        {
                            "context": "src",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "cast",
                            "parameter": [
                                {
                                    "valueId": "v"
                                },
                                {
                                    "valueString": "string"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "EDstring",
            "extends": "STstring",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "ED",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "string",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "ONstring",
            "extends": "STstring",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "ON",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "string",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "CSCode",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "code",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "code",
                    "source": [
                        {
                            "context": "src",
                            "element": "code",
                            "variable": "c"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "cast",
                            "parameter": [
                                {
                                    "valueId": "c"
                                },
                                {
                                    "valueString": "string"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "CECode",
            "extends": "CSCode",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CE",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "code",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "CDCode",
            "extends": "CSCode",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CD",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "code",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "CECodeableConcept",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CE",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "CodeableConcept",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "originalText",
                    "source": [
                        {
                            "context": "src",
                            "element": "originalText",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "text",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ]
                },
                {
                    "name": "code",
                    "source": [
                        {
                            "context": "src"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "coding",
                            "variable": "coding"
                        }
                    ],
                    "rule": [
                        {
                            "name": "code",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "code",
                                    "variable": "code"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "code",
                                    "transform": "cast",
                                    "parameter": [
                                        {
                                            "valueId": "code"
                                        },
                                        {
                                            "valueString": "string"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "codeSystem",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "codeSystem",
                                    "variable": "system"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "system",
                                    "transform": "translate",
                                    "parameter": [
                                        {
                                            "valueId": "system"
                                        },
                                        {
                                            "valueString": "http://hl7.org/fhir/ConceptMap/special-oid2uri"
                                        },
                                        {
                                            "valueString": "uri"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "displayName",
                            "source": [
                                {
                                    "context": "src",
                                    "element": "displayName",
                                    "variable": "display"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "display",
                                    "transform": "cast",
                                    "parameter": [
                                        {
                                            "valueId": "display"
                                        },
                                        {
                                            "valueString": "string"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "translation",
                    "source": [
                        {
                            "context": "src",
                            "element": "translation",
                            "variable": "translation"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "coding",
                            "variable": "coding"
                        }
                    ],
                    "rule": [
                        {
                            "name": "code",
                            "source": [
                                {
                                    "context": "translation",
                                    "element": "code",
                                    "variable": "code"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "code",
                                    "transform": "cast",
                                    "parameter": [
                                        {
                                            "valueId": "code"
                                        },
                                        {
                                            "valueString": "string"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "codeSystem",
                            "source": [
                                {
                                    "context": "translation",
                                    "element": "codeSystem",
                                    "variable": "system"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "system",
                                    "transform": "translate",
                                    "parameter": [
                                        {
                                            "valueId": "system"
                                        },
                                        {
                                            "valueString": "http://hl7.org/fhir/ConceptMap/special-oid2uri"
                                        },
                                        {
                                            "valueString": "uri"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "name": "displayName",
                            "source": [
                                {
                                    "context": "translation",
                                    "element": "displayName",
                                    "variable": "display"
                                }
                            ],
                            "target": [
                                {
                                    "context": "coding",
                                    "contextType": "variable",
                                    "element": "display",
                                    "transform": "cast",
                                    "parameter": [
                                        {
                                            "valueId": "display"
                                        },
                                        {
                                            "valueString": "string"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "CSCodeableConcept",
            "extends": "CECodeableConcept",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CS",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "CodeableConcept",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "CDCodeableConcept",
            "extends": "CECodeableConcept",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "CD",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "CodeableConcept",
                    "mode": "target"
                }
            ]
        },
        {
            "name": "ENHumanName",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "EN",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "HumanName",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "family",
                    "source": [
                        {
                            "context": "src",
                            "element": "family",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "family",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "given",
                    "source": [
                        {
                            "context": "src",
                            "element": "given",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "given",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "prefix",
                    "source": [
                        {
                            "context": "src",
                            "element": "prefix",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "prefix",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "suffix",
                    "source": [
                        {
                            "context": "src",
                            "element": "suffix",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "suffix",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "validTime",
                    "source": [
                        {
                            "context": "src",
                            "element": "validTime",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "period",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ]
                }
            ]
        },
        {
            "name": "ADAddress",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "AD",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Address",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "country",
                    "source": [
                        {
                            "context": "src",
                            "element": "country",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "country",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "state",
                    "source": [
                        {
                            "context": "src",
                            "element": "state",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "state",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "county",
                    "source": [
                        {
                            "context": "src",
                            "element": "county",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "district",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "city",
                    "source": [
                        {
                            "context": "src",
                            "element": "city",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "city",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "postalCode",
                    "source": [
                        {
                            "context": "src",
                            "element": "postalCode",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "postalCode",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "streetAddress",
                    "source": [
                        {
                            "context": "src",
                            "element": "streetAddressLine",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "line",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "streetName",
                    "source": [
                        {
                            "context": "src",
                            "element": "streetName",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "line",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "houseNumber",
                    "source": [
                        {
                            "context": "src",
                            "element": "houseNumber",
                            "variable": "v"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "line",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.dataString"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "addressUse",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "variable": "c"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "translate",
                            "parameter": [
                                {
                                    "valueId": "c"
                                },
                                {
                                    "valueString": "#addressUse"
                                },
                                {
                                    "valueString": "code"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "useablePeriod",
                    "source": [
                        {
                            "context": "src",
                            "element": "useablePeriod",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "period",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ]
                }
            ]
        },
        {
            "name": "TELContactPoint",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "TEL",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "ContactPoint",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "valuetel",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v",
                            "condition": "(src.value.startsWith('tel:'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.substring(4)"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "phone"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "valuefax",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v",
                            "condition": "(src.value.startsWith('fax:'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.substring(4)"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "fax"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "valuemail",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v",
                            "condition": "(src.value.startsWith('mailto:'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.substring(7)"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "email"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "valuehttp",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "v",
                            "condition": "(src.value.startsWith('http:'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "evaluate",
                            "parameter": [
                                {
                                    "valueString": "v.substring(5)"
                                }
                            ]
                        },
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "system",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "url"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "usehome",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "condition": "(src.use.startsWith('H'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "home"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "usework",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "condition": "((src.use = 'WP') or (src.use = 'DIR') or (src.use = 'PUB'))"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "work"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "usebad",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "condition": "(src.use = 'BAD')"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "old"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "usetmp",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "condition": "(src.use = 'TMP')"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "temp"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "usemobile",
                    "source": [
                        {
                            "context": "src",
                            "element": "use",
                            "condition": "(src.use = 'MC')"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "use",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueString": "mobile"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "useablePeriod",
                    "source": [
                        {
                            "context": "src",
                            "element": "useablePeriod",
                            "variable": "vvv"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "period",
                            "variable": "vvv",
                            "transform": "create"
                        }
                    ],
                    "documentation": "use: for src.use as c make tgt.use = translate(c, 'http://hl7.org/fhir/ConceptMap/cm-telecom-use-v3', 'code')"
                }
            ]
        },
        {
            "name": "PQQuantity",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "PQ",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Quantity",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "unit",
                    "source": [
                        {
                            "context": "src",
                            "element": "unit",
                            "variable": "unit"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "unit",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "unit"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "value",
                    "source": [
                        {
                            "context": "src",
                            "element": "value",
                            "variable": "value"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "value",
                            "transform": "copy",
                            "parameter": [
                                {
                                    "valueId": "value"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "RTOPQPQRatio",
            "extends": "Any",
            "typeMode": "types",
            "input": [
                {
                    "name": "src",
                    "type": "RTO_PQ_PQ",
                    "mode": "source"
                },
                {
                    "name": "tgt",
                    "type": "Ratio",
                    "mode": "target"
                }
            ],
            "rule": [
                {
                    "name": "numerator",
                    "source": [
                        {
                            "context": "src",
                            "element": "numerator",
                            "variable": "numerator"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "numerator",
                            "variable": "targetNumerator"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "PQQuantity",
                            "variable": [
                                "numerator",
                                "targetNumerator"
                            ]
                        }
                    ]
                },
                {
                    "name": "denominator",
                    "source": [
                        {
                            "context": "src",
                            "element": "denominator",
                            "variable": "denominator"
                        }
                    ],
                    "target": [
                        {
                            "context": "tgt",
                            "contextType": "variable",
                            "element": "denominator",
                            "variable": "targetDenominator"
                        }
                    ],
                    "dependent": [
                        {
                            "name": "PQQuantity",
                            "variable": [
                                "denominator",
                                "targetDenominator"
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}